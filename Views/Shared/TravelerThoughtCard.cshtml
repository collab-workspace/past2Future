@model Past2Future.Models.Comment

@{
    var isAdmin = Context.Session.GetString("IsAdmin") == "true";
    var returnUrl = Context.Request.Path + Context.Request.QueryString;
}

<div class="col-lg-6 col-md-12 mb-3">
    <div class="card bg-dark text-white h-100 shadow-sm position-relative">

        @if (isAdmin)
        {
            <form asp-controller="Home"
                  asp-action="DeleteTravelerComment"
                  method="post"
                  class="position-absolute"
                  style="top:10px; right:10px; z-index:5;">
                @Html.AntiForgeryToken()
                <input type="hidden" name="id" value="@Model.Id" />
                <input type="hidden" name="returnUrl" value="@returnUrl" />
                <button type="submit"
                        class="btn btn-sm btn-outline-danger"
                        title="Delete"
                        onclick="return confirm('Are you sure?');">
                    ✕
                </button>
            </form>
        }

        <div class="card-body d-flex flex-column">

        
            <div class="d-flex justify-content-between align-items-center mb-2">
                <div>
                    <span class="badge rounded-pill bg-primary">
                        @(Model.isHistory ? "History" : "Prediction")
                    </span>

                 
                    @if (!string.IsNullOrWhiteSpace(Model.Country?.Name))
                    {
                        <span class="badge rounded-pill bg-secondary ms-1">
                            @Model.Country!.Name
                        </span>
                    }
                </div>
            </div>

            <!-- USER -->
            <div class="d-flex align-items-center gap-2 mb-2">
                <i class="bi bi-person-circle"></i>
                <small class="text-secondary">
                    @(Model.User?.Username ?? "Guest")
                </small>
            </div>

            <!-- TITLE -->
            <h5 class="card-title">@Model.title</h5>

            <!-- TEXT -->
            <p class="card-text flex-grow-1">
                @Model.text
            </p>

            <!-- FOOTER -->
            <div class="d-flex justify-content-between align-items-end mt-2">
                <small class="text-white-50"> @Model.CreatedAt.ToString("dd MMM yyyy") </small>

                <button type="button" class="btn btn-sm btn-outline-light">
                    Read more
                </button>
            </div>

        </div>
    </div>
</div>

